SEQ_LEN = 30
BATCH_SIZE = 64
HIDDEN_UNITS = 256
EPOCHS = 50
VOCABULARY_SIZE = len(interval_to_number) + 1


print('Build model...')
model_interval = Sequential()
model_interval.add(Embedding(VOCABULARY_SIZE, HIDDEN_UNITS, input_length=SEQ_LEN, mask_zero=True))

# LSTM part
model_interval.add(LSTM(HIDDEN_UNITS, return_sequences=True))
model_interval.add(LSTM(HIDDEN_UNITS))

# Project back to vocabulary
model_interval.add(Dense(VOCABULARY_SIZE, activation='softmax'))
model_interval.compile(loss='sparse_categorical_crossentropy', optimizer='adam', metrics=['sparse_categorical_accuracy'])
model_interval.summary()